<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>RainClone ‚Äî Simple Demo</title>
<meta name="color-scheme" content="dark">
<style>
  :root{
    --bg:#06060b; --panel:#0f1216; --muted:#9aa0a6; --accent:#48d9ff; --gold:#f5c156;
    --card-radius:14px; --gap:18px; --glass: rgba(255,255,255,0.03);
    --accent-2:#7b61ff;
    --max-width:1200px;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:
    radial-gradient(700px 400px at 10% 10%, rgba(72,217,255,0.03), transparent),
    linear-gradient(180deg,#06060b,#0a0b0e); color:#e8f2f7}
  a{color:inherit}
  .wrap{max-width:var(--max-width);margin:18px auto;display:grid;grid-template-columns:220px 1fr 300px;gap:18px;align-items:start;padding:10px}
  header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between;padding:12px 8px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);border:1px solid rgba(255,255,255,0.02)}
  .brand{display:flex;gap:12px;align-items:center}
  .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:grid;place-items:center;font-weight:800}
  h1{font-size:18px;margin:0}
  .subtitle{color:var(--muted);font-size:13px}

  /* left column - games list column */
  .left { background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:var(--card-radius); padding:14px; border:1px solid rgba(255,255,255,0.02); height:calc(100vh - 120px); overflow:auto }
  .wallet{margin-bottom:12px}
  .balance{font-size:20px;font-weight:800;color:var(--gold)}
  .game-list{display:flex;flex-direction:column;gap:8px;margin-top:8px}
  .game-btn{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;background:transparent;border:1px solid transparent;color:var(--muted);cursor:pointer}
  .game-btn.active{background:linear-gradient(90deg, rgba(72,217,255,0.06), rgba(123,97,255,0.03)); color:var(--accent); border-color:rgba(72,217,255,0.06); box-shadow:0 8px 24px rgba(0,0,0,0.45)}
  .game-icon{width:38px;height:38;border-radius:8px;display:grid;place-items:center;background:rgba(255,255,255,0.02);font-weight:800}

  /* center - large game area (use most of screen) */
  .center { min-height:600px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:var(--card-radius); padding:18px; border:1px solid rgba(255,255,255,0.02); display:flex; flex-direction:column; gap:16px; }
  .home-grid{ display:grid; grid-template-columns: repeat(3, 1fr); gap:14px; align-items:stretch }
  .card{ background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent); border-radius:12px; padding:18px; display:flex; flex-direction:column; gap:12px; align-items:flex-start; border:1px solid rgba(255,255,255,0.02); cursor:pointer; transition: transform 200ms ease, box-shadow 200ms ease }
  .card:hover{ transform: translateY(-6px); box-shadow: 0 18px 40px rgba(0,0,0,0.6) }
  .card .title{font-weight:800; font-size:16px}
  .card .desc{color:var(--muted); font-size:13px}

  /* focused game uses most area */
  .focused{ display:flex; gap:18px; align-items:flex-start; }
  .focused .big{flex:1; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:12px; padding:18px; min-height:420px; border:1px solid rgba(255,255,255,0.02)}
  .focused .side-mini{ width:260px; display:flex; flex-direction:column; gap:10px }

  .big h2{margin:0;font-size:20px}
  .muted{color:var(--muted);font-size:13px}
  .controls{display:flex;gap:10px;align-items:center;margin-top:12px}
  .controls input[type=number]{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}

  /* crash canvas large */
  #crashCanvas{ width:100%; height:320px; border-radius:8px; background:linear-gradient(180deg, rgba(72,217,255,0.02), transparent) }

  /* dice large */
  .dice-area{ display:flex; gap:18px; align-items:center; justify-content:center; padding:18px }
  .dice-face{ font-size:64px; padding:12px 18px; background:rgba(255,255,255,0.02); border-radius:12px }

  /* mines big grid */
  .mines-grid{ display:grid; grid-template-columns: repeat(8, 1fr); gap:8px }
  .mine-cell{ height:56px; border-radius:8px; background:rgba(255,255,255,0.02); display:grid;place-items:center; cursor:pointer; font-weight:700; color:var(--muted) }
  .mine-open{ background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); color:#fff }

  /* slots big reels */
  .reel-big{ width:120px; height:160px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); display:grid; place-items:center; font-size:48px; font-weight:800 }

  /* right column - info */
  .right { background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border-radius:var(--card-radius); padding:14px; border:1px solid rgba(255,255,255,0.02); height:calc(100vh - 120px); overflow:auto }
  .ticker { margin-top:8px; display:flex; flex-direction:column; gap:8px }
  .ticker .row{ display:flex; justify-content:space-between; align-items:center; padding:8px; border-radius:8px; background:rgba(0,0,0,0.18) }

  /* responsive */
  @media (max-width:1100px){
    .wrap{ grid-template-columns: 1fr; padding:12px }
    .left, .right { height:auto }
    .home-grid{ grid-template-columns: repeat(2, 1fr) }
    .mines-grid{ grid-template-columns: repeat(6, 1fr) }
  }
</style>
</head>
<body>
<header>
  <div class="brand">
    <div class="logo">RC</div>
    <div>
      <h1>RainClone</h1>
      <div class="subtitle">Cleaner layout ‚Äî focused game, clearer flow</div>
    </div>
  </div>

  <div style="display:flex;align-items:center;gap:12px">
    <div class="muted">Balance</div>
    <div class="balance" id="topBalance">0 RC</div>
  </div>
</header>

<div class="wrap">
  <!-- LEFT: vertical game column -->
  <aside class="left">
    <div class="wallet">
      <div class="muted">Wallet</div>
      <div class="balance" id="wallet">0 RC</div>
      <div class="muted" style="margin-top:6px">Demo balance stored in localStorage</div>
    </div>

    <div style="margin-top:12px">
      <div class="muted">Games</div>
      <div class="game-list" id="gameList">
        <button class="game-btn active" data-game="home"><div class="game-icon">üè†</div> Games Home</button>
        <button class="game-btn" data-game="crash"><div class="game-icon">üìà</div> Crash</button>
        <button class="game-btn" data-game="dice"><div class="game-icon">üé≤</div> Dice</button>
        <button class="game-btn" data-game="mines"><div class="game-icon">üí£</div> Mines</button>
        <button class="game-btn" data-game="slots"><div class="game-icon">üé∞</div> Slots</button>
      </div>
    </div>

    <div style="margin-top:16px">
      <div class="muted">Quick actions</div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <input id="quickAdd" type="number" min="1" value="100" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit">
        <button id="addBtn" class="game-btn" style="justify-content:center">+ Add</button>
      </div>
    </div>

    <div style="margin-top:16px">
      <div class="muted">History</div>
      <div id="history" style="margin-top:8px;max-height:300px;overflow:auto;color:var(--muted);font-size:13px"></div>
    </div>
  </aside>

  <!-- CENTER: big focused area -->
  <main class="center" id="mainArea">
    <!-- Games Home -->
    <div id="homeView">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h2 style="margin:0">Games Home</h2>
          <div class="muted">Choose a game ‚Äî the game will open using most of the screen.</div>
        </div>
      </div>

      <div class="home-grid" style="margin-top:16px">
        <div class="card" data-open="crash">
          <div class="title">Crash</div>
          <div class="desc">Place a bet, cash out before it crashes. Fast-paced multiplier game.</div>
          <div class="muted">Autocashout and manual cashout supported.</div>
        </div>

        <div class="card" data-open="dice">
          <div class="title">Dice</div>
          <div class="desc">Simple roll-based game. Pick your target, roll high to win.</div>
          <div class="muted">Low complexity ‚Äî quick results.</div>
        </div>

        <div class="card" data-open="mines">
          <div class="title">Mines</div>
          <div class="desc">Pick safe tiles. Hitting a bomb ends the round.</div>
          <div class="muted">Risk vs reward ‚Äî the more you open, the more you get.</div>
        </div>

        <div class="card" data-open="slots">
          <div class="title">Slots</div>
          <div class="desc">Spin 3 reels ‚Äî match symbols to win.</div>
          <div class="muted">Big rewards for 3-in-a-row.</div>
        </div>

        <div class="card" data-open="crash">
          <div class="title">Try Crash</div>
          <div class="desc">Fast rounds ‚Äî good for practicing cashouts.</div>
        </div>

        <div class="card" data-open="mines">
          <div class="title">Try Mines</div>
          <div class="desc">Slower paced ‚Äî think carefully about each click.</div>
        </div>
      </div>
    </div>

    <!-- FOCUSED GAME AREA (hidden by default) -->
    <div id="gameView" style="display:none" class="focused">
      <div class="big" id="gameBig">
        <!-- dynamic content inserted here -->
      </div>
      <div class="side-mini">
        <div style="background:rgba(255,255,255,0.02);padding:12px;border-radius:10px">
          <div class="muted">Round Info</div>
          <div id="roundInfo" style="font-weight:800;margin-top:6px">‚Äî</div>
        </div>

        <div style="background:rgba(255,255,255,0.02);padding:12px;border-radius:10px">
          <div class="muted">Quick Controls</div>
          <div style="margin-top:8px">
            <div class="muted">Bet</div>
            <input id="sideBet" type="number" value="50" style="width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit">
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="sidePlace" class="game-btn" style="flex:1;justify-content:center">Place</button>
              <button id="sideCash" class="game-btn" style="flex:1;justify-content:center">Cashout</button>
            </div>
          </div>
        </div>

        <div style="background:rgba(255,255,255,0.02);padding:12px;border-radius:10px">
          <div class="muted">Recent wins</div>
          <div class="ticker" id="ticker"></div>
        </div>
      </div>
    </div>

  </main>

  <!-- RIGHT: small stats/ticker -->
  <aside class="right">
    <div style="display:flex;justify-content:space-between;align-items:center">
      <div><div class="muted">Leaderboard</div><div id="leaders" style="margin-top:8px"></div></div>
      <div><div class="muted">Stats</div><div id="stats" style="margin-top:8px">W:0 L:0</div></div>
    </div>

    <div style="margin-top:14px">
      <div class="muted">Provably-fair (demo)</div>
      <div class="muted" id="provableHash" style="margin-top:6px">‚Äî</div>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="newSeed" class="game-btn">New Server Seed</button>
        <button id="revealSeed" class="game-btn">Reveal</button>
      </div>
    </div>

    <div style="margin-top:14px">
      <div class="muted">Options</div>
      <div style="display:flex;gap:8px;margin-top:8px;align-items:center">
        <label style="display:flex;gap:6px;align-items:center"><input id="persist" type="checkbox" checked> Save</label>
        <button id="reset" class="game-btn">Reset</button>
      </div>
    </div>
  </aside>
</div>

<script>
/* Simple focused UI script
   - click left column or home cards to open a focused game
   - games available: crash, dice, mines, slots
   - stores demo balance in localStorage (if Save checked)
*/

// -- state & persistence
const initial = { balance: 1500, history: [], leaders: [], wins:0, losses:0, provableSeed: null, provableHash: null };
let state = JSON.parse(localStorage.getItem('rc_state') || 'null') || initial;
const persistCheckbox = () => document.getElementById('persist').checked;

// UI refs
const el = id => document.getElementById(id);
const topBalance = el('topBalance'), wallet = el('wallet'), historyEl = el('history'), leadersEl = el('leaders'), statsEl = el('stats'), ticker = el('ticker'), provableHash = el('provableHash');
const mainArea = el('mainArea'), homeView = el('homeView'), gameView = el('gameView'), gameBig = el('gameBig'), gameList = document.querySelectorAll('.game-btn');

// update UI
function updateHeader(){
  topBalance.innerText = `${state.balance} RC`;
  wallet.innerText = `${state.balance} RC`;
  statsEl.innerText = `W:${state.wins} L:${state.losses}`;
  provableHash.innerText = state.provableHash || '‚Äî';
  renderHistory();
  renderLeaders();
}
function saveState(){ if(persistCheckbox()) localStorage.setItem('rc_state', JSON.stringify(state)); }
function resetState(){ localStorage.removeItem('rc_state'); location.reload(); }

// history
function pushHist(text){
  const item = { text, time: new Date().toLocaleTimeString() };
  state.history.unshift(item);
  if(state.history.length>100) state.history.pop();
  saveState(); renderHistory();
}
function renderHistory(){
  historyEl.innerHTML = '';
  state.history.slice(0,12).forEach(h=>{
    const d = document.createElement('div');
    d.style.padding='6px'; d.style.borderBottom='1px solid rgba(255,255,255,0.02)'; d.innerHTML = `<div style="display:flex;justify-content:space-between"><div>${h.text}</div><div class="muted" style="font-size:12px">${h.time}</div></div>`;
    historyEl.appendChild(d);
  });
}

// leaders
function renderLeaders(){
  leadersEl.innerHTML = '';
  if(!state.leaders.length) { leadersEl.innerHTML = '<div class="muted">No big wins</div>'; return; }
  state.leaders.slice(0,6).forEach(l => {
    const d = document.createElement('div'); d.style.display='flex'; d.style.justifyContent='space-between'; d.style.padding='6px 0'; d.innerHTML = `<div>${l.name}</div><div class="muted">${l.win}</div>`;
    leadersEl.appendChild(d);
  });
}

// provable demo
function newSeed(){
  const seed = (Math.random().toString(36).slice(2)+Date.now().toString(36));
  state.provableSeed = seed;
  // sha-256 using subtle
  crypto.subtle.digest('SHA-256', new TextEncoder().encode(seed)).then(h=>{
    state.provableHash = Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('');
    provableHash.innerText = state.provableHash;
    saveState();
    pushHist('New server seed created (demo)');
  });
}
function revealSeed(){
  if(!state.provableSeed) return alert('No seed yet');
  alert('Server seed (demo): ' + state.provableSeed + '\nHash: ' + state.provableHash);
}

// default render
updateHeader();

// -- Left column interactions & home cards
document.querySelectorAll('.game-btn').forEach(btn=>{
  btn.addEventListener('click', ()=> {
    document.querySelectorAll('.game-btn').forEach(x => x.classList.remove('active'));
    btn.classList.add('active');
    openGame(btn.dataset.game);
  });
});
document.querySelectorAll('.card[data-open]').forEach(card=>{
  card.addEventListener('click', ()=> {
    const target = card.dataset.open;
    document.querySelectorAll('.game-btn').forEach(x => x.classList.remove('active'));
    document.querySelector(`[data-game="${target}"]`).classList.add('active');
    openGame(target);
  });
});

el('addBtn').addEventListener('click', ()=>{
  const v = parseFloat(el('quickAdd').value)||0;
  state.balance += v; pushHist(`Added ${v} RC`); updateHeader(); saveState();
});
el('reset').addEventListener('click', ()=> { if(confirm('Reset demo data?')) resetState(); });
el('newSeed').addEventListener('click', newSeed);
el('revealSeed').addEventListener('click', revealSeed);

// open game logic
function openGame(name){
  homeView.style.display = name === 'home' ? 'block' : 'none';
  gameView.style.display = name === 'home' ? 'none' : 'flex';
  gameBig.innerHTML = ''; // clear previous
  el('roundInfo').innerText = name.charAt(0).toUpperCase() + name.slice(1);
  if(name === 'crash') renderCrash();
  else if(name === 'dice') renderDice();
  else if(name === 'mines') renderMines();
  else if(name === 'slots') renderSlots();
  saveState();
}

// ------- Crash implementation (simplified, smooth) -------
function renderCrash(){
  gameBig.innerHTML = `
    <h2>Crash ‚Äî Focused</h2>
    <div class="muted">Place a bet and cash out before the multiplier crashes.</div>
    <canvas id="crashCanvasLarge" style="margin-top:12px;border-radius:8px;width:100%;height:320px;background:linear-gradient(180deg, rgba(72,217,255,0.02), transparent)"></canvas>
    <div class="controls" style="margin-top:12px">
      <div style="display:flex;gap:8px;align-items:center">
        <div class="muted">Bet</div>
        <input id="crashBetInput" type="number" value="50" style="width:120px">
        <div class="muted">Auto cashout</div>
        <input id="crashAutoInput" type="number" value="2.00" step="0.01" style="width:110px">
      </div>
      <div style="margin-left:auto;display:flex;gap:8px">
        <button id="crashStart" class="game-btn">Place & Start</button>
        <button id="crashCash" class="game-btn">Cashout</button>
      </div>
    </div>
    <div id="crashText" style="margin-top:10px" class="muted">Status: idle</div>
  `;
  const canvas = document.getElementById('crashCanvasLarge');
  const ctx = canvas.getContext('2d');
  function resize(){ canvas.width = canvas.clientWidth * devicePixelRatio; canvas.height = canvas.clientHeight * devicePixelRatio; ctx.setTransform(devicePixelRatio,0,0,devicePixelRatio,0,0); draw(1); }
  window.addEventListener('resize', resize); resize();

  let running=false, multiplier=1, crashPoint=0, bet=0;

  function draw(m){
    ctx.clearRect(0,0,canvas.clientWidth,canvas.clientHeight);
    // background
    ctx.fillStyle = 'rgba(255,255,255,0.02)';
    ctx.fillRect(0,0,canvas.clientWidth,canvas.clientHeight);
    // bar representing height
    const h = canvas.clientHeight;
    const w = canvas.clientWidth;
    const norm = Math.min(1, Math.log(m+1)/Math.log(10)); // normalize for visual
    const barHeight = 20 + (h-40) * norm;
    ctx.fillStyle = 'rgba(72,217,255,0.10)';
    ctx.fillRect(20, h - barHeight, w-40, barHeight);
    // multiplier text
    ctx.fillStyle = '#e8f2f7'; ctx.font = '20px sans-serif'; ctx.fillText(m.toFixed(2) + 'x', 30, 30);
  }

  function startRound(autoAt){
    if(running) return;
    bet = parseFloat(document.getElementById('crashBetInput').value) || 0;
    if(bet <= 0 || bet > state.balance){ alert('Invalid bet or insufficient funds'); return; }
    state.balance -= bet; updateHeader(); saveState();
    // determine crash point
    crashPoint = 1 + Math.random()*6; // simple distribution for demo
    multiplier = 1; running = true;
    document.getElementById('crashText').innerText = 'Running... crash at hidden';
    pushHist(`Crash start: bet ${bet} RC`);
    let last = performance.now();
    function frame(now){
      const dt = (now - last)/1000; last = now;
      multiplier += dt * (0.9 + Math.log(multiplier+1)*0.6);
      draw(multiplier);
      document.getElementById('crashText').innerText = `Running ‚Äî ${multiplier.toFixed(2)}x`;
      // auto cashout
      if(autoAt && multiplier >= autoAt){
        // win
        const profit = Math.round((bet*(autoAt-1))*100)/100;
        state.balance += bet + profit;
        state.wins = (state.wins||0) + 1;
        pushHist(`Crash auto cashout @${autoAt}x +${profit} RC`);
        running = false; updateHeader(); saveState(); return;
      }
      if(multiplier >= crashPoint){
        // crashed
        state.losses = (state.losses||0) + 1;
        pushHist(`Crash crashed at ${multiplier.toFixed(2)}x -${bet} RC`);
        running=false; updateHeader(); saveState(); return;
      }
      if(running) requestAnimationFrame(frame);
    }
    requestAnimationFrame(frame);
  }

  document.getElementById('crashStart').addEventListener('click', ()=> {
    const auto = parseFloat(document.getElementById('crashAutoInput').value) || null;
    startRound(auto);
  });
  document.getElementById('crashCash').addEventListener('click', ()=> {
    // simplified: manual cashout uses current multiplier approximate
    if(!running){ alert('No running round'); return; }
    const cur = multiplier;
    const profit = Math.round((bet*(cur-1))*100)/100;
    state.balance += bet + profit; state.wins = (state.wins||0) + 1;
    pushHist(`Crash manual cashout @${cur.toFixed(2)}x +${profit} RC`);
    running=false; updateHeader(); saveState();
  });
}

function renderDice(){
  gameBig.innerHTML = `
    <h2>Dice ‚Äî Focused</h2>
    <div class="muted">Pick a target (4-6). Roll 1-6. Higher roll wins depending on your target.</div>
    <div class="dice-area" style="margin-top:12px">
      <div style="display:flex;flex-direction:column;gap:8px;align-items:center">
        <div class="muted">Your pick</div>
        <select id="dicePick" style="padding:8px;border-radius:8px">
          <option value="4">‚â• 4</option><option value="5">‚â• 5</option><option value="6">= 6</option>
        </select>
        <div style="margin-top:8px" class="muted">Bet</div>
        <input id="diceBet" type="number" value="50" style="width:120px;padding:8px;border-radius:8px">
        <button id="diceRollBtn" class="game-btn" style="margin-top:10px">Roll</button>
      </div>

      <div style="display:flex;flex-direction:column;align-items:center">
        <div class="muted">Result</div>
        <div id="diceFace" class="dice-face">‚Äî</div>
        <div id="diceMsg" class="muted" style="margin-top:8px">Roll to play</div>
      </div>
    </div>
  `;
  document.getElementById('diceRollBtn').addEventListener('click', ()=>{
    const pick = parseInt(document.getElementById('dicePick').value,10);
    const bet = parseFloat(document.getElementById('diceBet').value)||0;
    if(bet>state.balance){ alert('Insufficient funds'); return; }
    state.balance -= bet; updateHeader();
    const roll = Math.floor(Math.random()*6)+1;
    let win=false, profit=0;
    if(pick===6){ if(roll===6){ win=true; profit = bet*5; } }
    else { if(roll>=pick){ win=true; profit = Math.round((bet * (6/(6-(pick-1)) - 1))*100)/100; } }
    document.getElementById('diceFace').innerText = roll;
    if(win){ state.balance += bet + profit; state.wins = (state.wins||0)+1; pushHist(`Dice win +${profit} RC`); document.getElementById('diceMsg').innerText = `WIN +${profit} RC`; }
    else { state.losses = (state.losses||0)+1; pushHist(`Dice lose -${bet} RC`); document.getElementById('diceMsg').innerText = `LOSE -${bet} RC`; }
    updateHeader(); saveState();
  });
}

function renderMines(){
  gameBig.innerHTML = `
    <h2>Mines ‚Äî Focused</h2>
    <div class="muted">Pick safe tiles. Hitting a bomb loses the round.</div>
    <div style="display:flex;gap:12px;margin-top:12px;align-items:center">
      <div>
        <div class="muted">Bombs</div>
        <select id="bombsSel" style="padding:8px;border-radius:8px">
          <option value="3">3</option><option value="5" selected>5</option><option value="8">8</option>
        </select>
      </div>
      <div>
        <div class="muted">Bet</div>
        <input id="minesBet" type="number" value="50" style="width:120px;padding:8px;border-radius:8px">
      </div>
      <div style="margin-left:auto">
        <button id="minesStart" class="game-btn">Start</button>
        <button id="minesCash" class="game-btn">Cashout</button>
      </div>
    </div>
    <div class="mines-grid" id="minesGrid" style="margin-top:12px"></div>
    <div id="minesMsg" class="muted" style="margin-top:10px"></div>
  `;
  const grid = el('minesGrid');
  let bombs=new Set(), opened=new Set(), bet=0, running=false;
  function makeGrid(){
    grid.innerHTML='';
    for(let i=0;i<48;i++){
      const cell = document.createElement('div'); cell.className='mine-cell'; cell.dataset.i = i; cell.innerText = '';
      cell.addEventListener('click', ()=> {
        if(!running) return;
        if(opened.has(i)) return;
        opened.add(i);
        if(bombs.has(i)){
          cell.classList.add('mine-open'); cell.innerText='üí£'; running=false; state.losses = (state.losses||0)+1; pushHist(`Mines hit bomb -${bet} RC`); updateHeader(); saveState(); el('minesMsg').innerText = 'Boom ‚Äî you hit a bomb.';
        } else {
          cell.classList.add('mine-open'); cell.innerText='‚Ä¢'; const mul = 1 + (opened.size * 0.12);
          el('minesMsg').innerText = `Safe ‚Äî multiplier x${mul.toFixed(2)} ‚Äî open more or cashout.`;
        }
      });
      grid.appendChild(cell);
    }
  }
  makeGrid();
  el('minesStart').addEventListener('click', ()=>{
    bet = parseFloat(el('minesBet').value)||0; if(bet>state.balance){ alert('Not enough'); return; }
    state.balance -= bet; updateHeader(); running = true; opened.clear();
    bombs.clear();
    const count = parseInt(el('bombsSel').value,10);
    while(bombs.size < count) bombs.add(Math.floor(Math.random()*48));
    grid.querySelectorAll('.mine-cell').forEach(c => { c.classList.remove('mine-open'); c.innerText=''; });
    pushHist(`Mines started -${bet} RC`);
    saveState();
  });
  el('minesCash').addEventListener('click', ()=>{
    if(!running){ alert('No running mines'); return; }
    const mul = 1 + (opened.size * 0.12); const profit = Math.round((bet * (mul-1))*100)/100;
    state.balance += bet + profit; state.wins=(state.wins||0)+1; running=false; pushHist(`Mines cashed x${mul.toFixed(2)} +${profit} RC`); updateHeader(); saveState(); el('minesMsg').innerText='Cashed out!';
  });
}

function renderSlots(){
  gameBig.innerHTML = `
    <h2>Slots ‚Äî Focused</h2>
    <div class="muted">Spin 3 reels. Match symbols for wins.</div>
    <div style="display:flex;gap:16px;align-items:center;margin-top:12px">
      <div style="display:flex;gap:12px">
        <div class="reel-big" id="sr1">üçí</div>
        <div class="reel-big" id="sr2">üçã</div>
        <div class="reel-big" id="sr3">üîî</div>
      </div>
      <div style="margin-left:auto;display:flex;flex-direction:column;gap:8px;align-items:flex-end">
        <div class="muted">Bet</div>
        <input id="slotsBet" type="number" value="50" style="width:120px;padding:8px;border-radius:8px">
        <button id="spinBtn" class="game-btn">Spin</button>
        <div id="slotsMsg" class="muted" style="margin-top:6px">Match 3 for jackpot.</div>
      </div>
    </div>
  `;
  const symbols = ['üçí','üçã','üîî','‚≠ê','7Ô∏è‚É£'];
  const r1 = el('sr1'), r2 = el('sr2'), r3 = el('sr3');
  el('spinBtn').addEventListener('click', ()=>{
    const bet = parseFloat(el('slotsBet').value)||0;
    if(bet>state.balance){ alert('Not enough'); return; }
    state.balance -= bet; updateHeader();
    // animate sim
    r1.innerText = symbols[Math.floor(Math.random()*symbols.length)];
    r2.innerText = symbols[Math.floor(Math.random()*symbols.length)];
    r3.innerText = symbols[Math.floor(Math.random()*symbols.length)];
    // evaluate
    let win=false, profit=0;
    if(r1.innerText === r2.innerText && r2.innerText === r3.innerText){
      profit = r1.innerText === '7Ô∏è‚É£' ? bet * 50 : bet * 10; win=true;
    } else if (r1.innerText === r2.innerText || r2.innerText === r3.innerText || r1.innerText === r3.innerText){
      profit = bet * 2; win=true;
    }
    if(win){ state.balance += bet + profit; state.wins=(state.wins||0)+1; pushHist(`Slots win +${profit} RC`); el('slotsMsg').innerText = `Win +${profit} RC`; } else { state.losses=(state.losses||0)+1; pushHist(`Slots lose -${bet} RC`); el('slotsMsg').innerText = `No match`; }
    updateHeader(); saveState();
  });
}

// start on home
openGame('home');
updateHeader();

// wire side quick place/cash (generic)
el('sidePlace').addEventListener('click', ()=> {
  const active = [...document.querySelectorAll('.game-btn')].find(b => b.classList.contains('active'));
  if(active) openGame(active.dataset.game);
});
el('sideCash').addEventListener('click', ()=> alert('Use the game cashout controls in the focused view'));

// persist checkbox handling
el('persist').addEventListener('change', ()=> saveState());

// quick ticker render (recent history)
function updateTicker(){
  ticker.innerHTML = '';
  state.history.slice(0,6).forEach(h=>{
    const r = document.createElement('div'); r.className='row'; r.innerHTML = `<div style="font-weight:700">${h.text}</div><div class="muted">${h.time}</div>`;
    ticker.appendChild(r);
  });
}
setInterval(()=>{ updateHeader(); updateTicker(); }, 800);

// on load attempt new seed for provable if none
if(!state.provableSeed) {
  const s = (Math.random().toString(36).slice(2)+Date.now().toString(36));
  state.provableSeed=s;
  crypto.subtle.digest('SHA-256', new TextEncoder().encode(s)).then(h=>{
    state.provableHash = Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('');
    saveState();
    updateHeader();
  });
}
</script>
</body>
</html>
